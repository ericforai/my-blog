---
import PageLayout from '~/layouts/PageLayout.astro';

// 获取所有标签
export async function getStaticPaths() {
  return [
    { params: { tag: 'AI' } },
    { params: { tag: 'AI营销' } },
    { params: { tag: 'AI工具' } },
    { params: { tag: '未来趋势' } },
    { params: { tag: 'AGI' } },
    { params: { tag: '多模态AI' } },
    { params: { tag: '数字营销' } },
    { params: { tag: '营销自动化' } },
    { params: { tag: '生产力' } },
    { params: { tag: 'ChatGPT' } },
    { params: { tag: 'Midjourney' } },
    { params: { tag: 'Prompt Engineering' } },
    { params: { tag: '技术教程' } },
    { params: { tag: '开源' } },
  ];
}

const { tag } = Astro.params;

// 所有文章
const allPosts = [
  {
    title: "AI 未来十年的关键词：重新定义智能时代的边界",
    description: "从 AGI 到多模态，从开源革命到伦理觉醒，解读未来十年将主导 AI 发展的 10 个核心关键词",
    pubDate: "2025-10-07",
    slug: "ai-future-decade-keywords",
    category: "AI 趋势",
    tags: ["AI", "未来趋势", "AGI", "多模态AI", "开源"]
  },
  {
    title: "AI 重塑营销：从内容生产到精准投放的全链路革命",
    description: "深度解析 AI 如何改变营销的每个环节，从文案创作、视觉设计到数据分析，附实战案例与工具推荐",
    pubDate: "2025-10-07",
    slug: "ai-marketing-revolution",
    category: "AI 营销",
    tags: ["AI营销", "数字营销", "营销自动化", "内容创作"]
  },
  {
    title: "2025 年必备的 10 个 AI 工具：让生产力飞跃的秘密武器",
    description: "精选 10 个经过实战检验的 AI 工具，涵盖写作、编程、设计、数据分析等场景，附使用技巧与对比评测",
    pubDate: "2025-10-07",
    slug: "ai-tools-2025",
    category: "AI 工具",
    tags: ["AI工具", "生产力", "ChatGPT", "Midjourney", "GitHub Copilot"]
  },
  {
    title: "Prompt Engineering：AI 时代的新编程语言",
    description: "深入探索 Prompt Engineering 的核心原理、实用技巧与最佳实践，掌握与 AI 对话的艺术",
    pubDate: "2025-10-07",
    slug: "prompt-engineering",
    category: "技术实践",
    tags: ["AI", "Prompt Engineering", "ChatGPT", "技术教程"]
  }
];

// 筛选包含当前标签的文章
const posts = allPosts.filter(post => post.tags.includes(tag as string));

// 格式化日期
const formatDate = (date: string) => {
  return new Date(date).toLocaleDateString('zh-CN', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
};
---

<PageLayout 
  title={`标签: ${tag} - AI小孩`} 
  description={`查看所有标记为 "${tag}" 的文章`}
>
  <div class="mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8">
    <!-- 标签标题 -->
    <div class="mb-12">
      <div class="flex items-center gap-3 mb-4">
        <span class="text-4xl">🏷️</span>
        <h1 class="text-page-title">标签: {tag}</h1>
      </div>
      <p class="text-lg text-gray-600 dark:text-gray-400">
        共找到 {posts.length} 篇相关文章
      </p>
      <div class="mt-4">
        <a href="/blog" class="text-primary hover:underline">
          ← 返回所有文章
        </a>
      </div>
    </div>

    <!-- 文章列表 -->
    {posts.length > 0 ? (
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {posts.map((post) => (
          <article class="group flex flex-col overflow-hidden rounded-lg border border-gray-200 transition-all hover:shadow-lg dark:border-gray-800">
            <!-- 文章封面 -->
            <div class="aspect-video bg-gradient-to-br from-primary/20 to-accent/20">
              <div class="flex h-full items-center justify-center">
                <span class="text-4xl">🤖</span>
              </div>
            </div>
            
            <!-- 文章信息 -->
            <div class="flex flex-1 flex-col p-6">
              <!-- 分类标签 -->
              <div class="mb-2">
                <span class="inline-block rounded-full bg-primary/10 px-3 py-1 text-xs font-medium text-primary">
                  {post.category}
                </span>
              </div>

              <div class="mb-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400">
                <time datetime={post.pubDate}>{formatDate(post.pubDate)}</time>
              </div>
              
              <h2 class="mb-3 text-xl font-bold group-hover:text-primary">
                <a href={`/blog/${post.slug}`} class="hover:underline">
                  {post.title}
                </a>
              </h2>
              
              <p class="mb-4 flex-1 text-gray-600 dark:text-gray-400">
                {post.description}
              </p>
              
              <!-- 标签 -->
              {post.tags && post.tags.length > 0 && (
                <div class="flex flex-wrap gap-2">
                  {post.tags.map((t) => (
                    <a 
                      href={`/tag/${t}`}
                      class={`rounded-full px-2 py-1 text-xs transition-colors ${
                        t === tag 
                          ? 'bg-primary text-white' 
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700'
                      }`}
                    >
                      {t}
                    </a>
                  ))}
                </div>
              )}
              
              <!-- 阅读按钮 -->
              <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
                <a
                  href={`/blog/${post.slug}`}
                  class="inline-flex items-center text-sm font-medium text-primary hover:underline"
                >
                  阅读全文 →
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    ) : (
      <div class="rounded-lg border border-gray-200 p-12 text-center dark:border-gray-800">
        <span class="text-6xl mb-4 block">🏷️</span>
        <p class="text-xl text-gray-600 dark:text-gray-400">
          未找到包含标签 "{tag}" 的文章
        </p>
      </div>
    )}
  </div>
</PageLayout>

